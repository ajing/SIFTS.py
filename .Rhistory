plot(X, xlab = "Average Distance", ylab = "Standard Deviation", log = "x", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 10
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=100)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 50
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=1000)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/disease_dist_summary.txt"
disease_dist_var = read.table(filename, sep="\t", header=F)
X <- disease_dist_var[,c(1,2)]
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", xlim = c(0,200), ylim=c(0,80),pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", xlim = c(0,190), ylim=c(0,80),pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", xlim = c(0,185), ylim=c(0,80),pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/disease_dist_summary.txt"
disease_dist_var = read.table(filename, sep="\t", header=F)
X <- disease_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", xlim = c(0,185), ylim=c(0,80),pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
filename = "/tmp/polym_dist_summary.txt"
poly_dist_var = read.table(filename, sep="\t", header=F)
X <- poly_dist_var[,c(1,2)]
## some pretty colors
library(RColorBrewer)
k <- 5
my.cols <- rev(brewer.pal(k, "RdYlBu"))
## compute 2D kernel density, see MASS book, pp. 130-131
z <- kde2d(X[,1], X[,2], n=50)
#levels <- sapply(prob, function(x) {approx(c1, sz, xout = 1 - x)$y })
jpeg("contour.jpg")
plot(X, xlab = "Average Distance", ylab = "Standard Deviation", xlim = c(0,185), ylim=c(0,80),pch=19, cex=.4)
#contour(z, levels= round (levels,7), add=TRUE, col = "red")
contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE, lwd=4)
abline(h=mean(X[,2]), v=mean(X[,1]), lwd=2)
legend("topleft", paste("R=", round(cor(X)[1,2],2)), bty="n")
dev.off()
library(ggplot2)
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interestingfig <- function(interest_idx){
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
}
interestingfig(1)
interest_idx
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx=1
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx=2
interested
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
all_dist
all_dist[1,]
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
all_dist[1]
all_dist[1.]
all_dist[1,]
interest_idx
interest_idx = 1
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
dim(all_dist)
all_dist[1,]
all_dist[2,]
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested)
dev.off()
ggplot(all_dist, aes(distance , fill = type)) + xlim(0,50) + geom_density(alpha = 0.2) + labs(title=interested)
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + xlim(0,50) + geom_density(alpha = 0.2) + labs(title=interested)
dev.off()
dev.off()
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested)
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested)
dev.off()
dev.off()
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + xlim(0,600) + geom_density(alpha = 0.2) + labs(title=interested)
ggplot(all_dist, aes(distance , fill = type)) + xlim(0,60) + geom_density(alpha = 0.2) + labs(title=interested)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,60)
dev.off()
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.1) + labs(title=interested) + xlim(0,70)
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.1) + labs(title=interested) + xlim(0,70)
dev.off()
dev.off()
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.05) + labs(title=interested) + xlim(0,70)
dev.off()
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,70)
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,70)
dev.off()
dev.off()
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,60)
dev.off()
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,80)
dev.off()
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,90)
dev.off()
interest_idx=2
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx = 3
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx
interest_idx=4
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx = 5
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
interest_idx
interest_idx = 6
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
index = dist_var[,1] < 20 & dist_var[,2] >50
interested = dist_var[index,6][interest_idx]
filename = "/tmp/snp_dist_desc_2.txt"
dist_var = read.table(filename, sep="\t", quote = "", header=F)
index    = (as.character(dist_var[,5]) == as.character(interested))
dist_var = dist_var[index, c(1,2)]
all_dist = dist_var
all_dist$distance = dist_var[,1]
all_dist$type = dist_var[,2]
print(dim(all_dist))
print(colnames(all_dist))
atitle = paste("/users/ajing/SNPDist/", "interest_fam_", interest_idx, ".jpg", sep="")
jpeg(atitle)
ggplot(all_dist, aes(distance , fill = type)) + geom_density(alpha = 0.2) + labs(title=interested) + xlim(0,50)
dev.off()
histpercent <- function(filename, datavector, gtitle, xlabel, ylabel){
jpeg(filename)
disthist = hist(datavector)
disthist$counts = disthist$counts / sum(disthist$count)
plot(disthist, main = gtitle, ylab = ylabel, xlab = xlabel)
dev.off()
}
X <- disease_dist_var[,1]
histpercent("bsdist_hist.jpg", X[[X,1]<10000,1], "Distance to Binding Site", "Distance in Angstrom", "Probability")
histpercent("bsdist_hist.jpg", X[X[,1]<10000,1], "Distance to Binding Site", "Distance in Angstrom", "Probability")
dim(X)
length(X)
histpercent("bsdist_hist.jpg", X[X<10000], "Distance to Binding Site", "Distance in Angstrom", "Probability")
dev.off()
dev.off()
histpercent("bsdist_hist.jpg", X[X<50], "Distance to Binding Site", "Distance in Angstrom", "Probability")
histpercent <- function(filename, datavector, gtitle, xlabel, ylabel){
jpeg(filename)
disthist = hist(datavector, breaks = 20)
disthist$counts = disthist$counts / sum(disthist$count)
plot(disthist, main = gtitle, ylab = ylabel, xlab = xlabel)
dev.off()
}
X <- disease_dist_var[,1]
histpercent("bsdist_hist.jpg", X[X<50], "Distance to Binding Site", "Distance in Angstrom", "Probability")
histpercent <- function(filename, datavector, gtitle, xlabel, ylabel){
jpeg(filename)
disthist = hist(datavector, breaks = 10)
disthist$counts = disthist$counts / sum(disthist$count)
plot(disthist, main = gtitle, ylab = ylabel, xlab = xlabel)
dev.off()
}
X <- disease_dist_var[,1]
histpercent("bsdist_hist.jpg", X[X<50], "Distance to Binding Site", "Distance in Angstrom", "Probability")
histpercent("bsdist_hist.jpg", X[X<50], "Distance to Binding Site", "Average Distance in Angstrom", "Probability")
histpercent <- function(filename, datavector, gtitle, xlabel, ylabel){
jpeg(filename)
disthist = hist(datavector, breaks = 10)
disthist$counts = disthist$counts / sum(disthist$count)
plot(disthist, main = gtitle, ylab = ylabel, xlab = xlabel)
dev.off()
}
X <- disease_dist_var[,1]
histpercent("bsdist_hist.jpg", X[X<50], "Average Distance Distribution", "Average Distance in Angstrom", "Probability")
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
dist_var[1,]
filename = "/tmp/std_pair_5.txt"
dist_var = read.table(filename, sep="\t", header=F)
jpeg("dist_var_pair.jpg")
scatter2D(dist_var[,3], dist_var[,4], colvar=dist_var[,5], xlab = "Diseases", ylab = "Polymorephism", clab = "Family Size(PDBs)" ,pch
= 19, main = "Standard Deviation of Distance")
abline(0,1)
index = dist_var[,3] < 20 & dist_var[,4] >50
text(dist_var[index,3], dist_var[index,4], dist_var[index,6], cex=0.7, pos=1, col="black")
dev.off()
filename = "/tmp/snpinfamily.txt"
outfile = read.table(filename)
outfile = read.table(filename,sep="\t")
outfile
outfile = read.table(filename,sep="\t",quote="")
outfile[1,]
outfile[,1]
jpeg("snp_family_hist.jpg")
hist(outfile[,1])
dev.off()
filename = "/tmp/snpinfamily.txt"
content <- read.table(filename, sep="\t", quote = "")
jpeg("snp_family_hist.jpg")
hist(content[,1], log = "x", xlab = "The number of SNP in a family", ylab = "Frequency", main = "Histogram of SNP number in each family")
dev.off()
filename = "/tmp/snpinfamily.txt"
content <- read.table(filename, sep="\t", quote = "")
jpeg("snp_family_hist.jpg")
hist(content[,1], xlab = "The number of SNP in a family", ylab = "Frequency", main = "Histogram of SNP number in each family")
dev.off()
content[,2]
content[content[1] > 1000,2]
content[content[1] > 1000,]
str(list)
str(list())
str()
ls()
poly_dist_var
ls()
rm
exit
q()
ls()
exit
q()
=======
surface <- read.table("./Result/avedist2surface.txt_small", sep = "\t", header = F)
library("ggplot2")
View(surface)
View(surface)
View(surface)
colnames(surface)<-c("pdbid", "chainid", "resnum", "resnam", "surf_dist", "surf_dist_alpha")
View(surface)
qplot(surf_dist, data = surface)
qplot(surf_dist, data = surface, geom="density")
qplot(surf_dist, data = surface, geom="density", log="x")
qplot(surf_dist, data = surface, geom="density", log="x") + qplot(surf_dist, data = surface, geom="density", log="x")
qplot(surf_dist, data = surface, geom="density", log="x") + ggplot(surface, aes(surf_dist_alpha)) + geom_histogram()
ggplot(surface, aes(surf_dist_alpha)) + geom_histogram()
surface <- melt(surface, id = c("pdbid","chainid","resnam","surf_dist","sur_dist_alpha"))
library("reshape")
library("reshape")
install.packages("reshape")
install.packages("reshape2")
library("reshape2")
surface <- melt(surface, id = c("pdbid","chainid","resnum", "resnam"))
View(surface)
View(surface)
qplot(value, data = surface, color = variable, geom="density", log="x")
library("ggplot2")
qplot(value, data = surface, color = variable, geom="density", log="x")
summary(surface)
newsurf<-subset(surface, value != "None")
summary(newsurf)
newsurf<-data.frame(newsurf)
summary(newsurf)
subset(newsurf, is.numeric(value))
subset(newsurf, !is.numeric(value))
subset(newsurf, !is.na(as.numeric(value))
)
subset(newsurf, is.na(as.numeric(value)))
surface <- newsurf
rm(newsurf)
surface$value <- as.numeric(surface$value)
summary(surface)
qplot(value, data = surface, color = variable, geom="density", log="x")
last_plot() + coord_cartesian(xlim = c(1, 100))
qplot(value, data = surface, color = resname, geom="density", log="x")
qplot(value, data = surface, color = resnam, geom="density", log="x")
qplot(value, data = surface, geom="density", log="x") + facet_grid(resnam~.)
qplot(value, data = surface, geom="density", log="x") + facet_wrap(resnam~.)
unique
aanam = unique(surface$resnam)
aanam
aanam <- c('ALA', 'ARG', 'ASN', 'ASP', 'ASX', 'CYS', 'GLU', 'GLN', 'GLX', 'GLY', 'HIS', 'ILE', 'LEU', 'LYS', 'MET', 'PHE', 'PRO', 'SER', 'THR', 'TRP', 'TYR', 'VAL')
qplot(value, data = subset(surface,resnam %in% aanam[:10]), color = resnam, geom="density", log="x")
aanam[:10]
aanam[1]
aanam[1:10]
qplot(value, data = subset(surface,resnam %in% aanam[1:11]), color = resnam, geom="density", log="x")
qplot(value, data = subset(surface,resnam %in% aanam[1:11]), color = resnam, geom="density", log="x") + coord_cartesian(xlim = c(1,50))
qplot(value, data = subset(surface,resnam %in% aanam[1:11]), color = resnam, geom="density", log="x") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[1:11]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% c("HIS")), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density" size = 2) + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density", size = 2) + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density", size = 1) + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + geom_line(aes(size=2)) + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density", size=1) + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(log(value), data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10))
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10)) + scale_x_continuous(trans=log2_trans())
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density") + coord_cartesian(xlim = c(1,10)) + coord_trans(x="log2")
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density")  + coord_trans(x="log2")+ coord_cartesian(xlim = c(1,10))
library(scale)
library("scale")
library("scales")
qplot(value, data = subset(surface,resnam %in% aanam[12:22]), color = resnam, geom="density")  + scale_x_continuous(trans=log2_trans())+ coord_cartesian(xlim = c(1,10))
length(subset(surface, value == 0))
snp_dist <-read.csv(".\Result\snp_dist.txt",sep="\t", header=F)
snp_dist <-read.csv(r".\Result\snp_dist.txt",sep="\t", header=F)
snp_dist <-read.csv("./Result/snp_dist.txt",sep="\t", header=F)
View(snp_dist)
View(snp_dist)
colnames(snp_dist)<-c("pdbid","snpid1","chainid1","resnam1","resnum1","snpid2","chainid2","resnam2","resnum2", "spa_dist","seq_dist")
View(snp_dist)
qplot(spa_dist, seq_dist, data=snp_dist)
ggplot(spa_dist, aes(x=spa_dist, y=seq_dist)) + stat_bin()
ggplot(snp_dist, aes(x=spa_dist, y=seq_dist)) + stat_bin()
ggplot(snp_dist, aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
ggplot(subset(snp_dist, seq_dist != False), aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
ggplot(subset(snp_dist, seq_dist != F), aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
summary(snp_dist)
ggplot(subset(snp_dist, seq_dist != False), aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
ggplot(subset(snp_dist, seq_dist != FALSE), aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
summary(subset(snp_dist, seq_dist != FALSE))
summary(subset(snp_dist, seq_dist != 'FALSE'))
summary(subset(snp_dist, seq_dist != 'False'))
snp_dist_nofalse <- subset(snp_dist, seq_dist != 'False')
snp_dist_nofalse$seq_dist <- as.numeric(snp_dist_nofalse$seq_dist)
summary(snp_dist_nofalse)
ggplot(subset(snp_dist_nofalse, seq_dist != FALSE), aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
humsavar <- read.csv("./Data/humsavar_tru.txt",sep="\t",header=F)
View(humsavar)
humsavar <- read.csv("./Data/humsavar_tru.txt",header=F)
humsavar <- read.table("./Data/humsavar_tru.txt",header=F)
humsavar <- read.table("./Data/humsavar_tru.txt.out", sep="\t",header=F)
View(humsavar)
humsavar <- read.table("./Data/humsavar_tru.txt.out", sep="\t",header=F, quote="")
View(humsavar)
humsavar <- subset(humsavar, V6 !="-")
humsavar <- humsavar[,c("V5","V6")]
View(humsavar)
colnames(humsavar)<-c("type", "snpid")
View(humsavar)
snp_dist_nof_var<-merge(x = snp_dist_nofalse, y = humsavar, by = "snpid", all.x=TRUE)
View(snp_dist_nofalse)
snp_dist_nof_var<-merge(x = snp_dist_nofalse, y = humsavar, by.x = "snpid1", by.y="snpid2", all.x=TRUE)
snp_dist_nof_var<-merge(x = snp_dist_nofalse, y = humsavar, by.x = "snpid1", by.y="snpid", all.x=TRUE)
View(snp_dist_nof_var)
colnames(snp_dist_nof_var)[-1]
colnames(snp_dist_nof_var)[11]
colnames(snp_dist_nof_var)[12]
colnames(snp_dist_nof_var)[12]<- "type1"
snp_dist_nof_var<-merge(x = snp_dist_nof_var, y = humsavar, by.x = "snpid2", by.y="snpid", all.x=TRUE)
View(snp_dist_nof_var)
summary(snp_dist_nof_var)
table(snp_dist_nof_var$pdbid)
as.data.frame(table(snp_dist_nof_var$pdbid)()
)
as.data.frame(table(snp_dist_nof_var$pdbid))
dim(as.data.frame(table(snp_dist_nof_var$pdbid)))
ggplot(snp_dist_nof_var, aes(x=spa_dist, y=seq_dist)) + geom_bin2d()
ggplot(snp_dist_nof_var, aes(x=spa_dist, y=seq_dist, color = type1)) + geom_bin2d()
ggplot(snp_dist_nof_var, aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type ~.)
ggplot(snp_dist_nof_var, aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" && type2 != "unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 ~.)
colnames(snp_dist_nof_var)[14]
colnames(snp_dist_nof_var)[13]
colnames(snp_dist_nof_var)[13] <- "type2"
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" | type2 != "unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" | type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" | type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
summary(subset(snp_dist_nof_var,type1 != "Unclassified" | type2 != "Unclassified"))
summary(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(c(type1, type2) ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_bin2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_density2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_contour() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..)) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_density2d(aes(fill=..level..)) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_smooth(aes(fill=..level..)) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + geom_density2d(aes(fill=..level..)) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist, fill=..level..)) + geom_density2d( + facet_grid(type1 + type2 ~.)
)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist, fill=..level..)) + geom_density2d() + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist, fill=..level..)) + stat_density2d() + geom_tile()+ facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..)) + geom_tile()+ facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..)) + geom_tile()+ scale_fill_gradient(limits=c(0,0.04)) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..)) + geom_tile()+ scale_fill_gradient(limits=c(0,0.04), low="white",high="black") + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..), geom="tile") + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..), geom="polygon") + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..), geom="bin") + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(aes(fill=..level..), geom="bin2d") + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..level..), contour=FALSE) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~., scales = "free_z")
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~., scales = "free_y")
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~.)
add_type_column <- function(onerow){
if (onerow$type1 == onerow$type2) {
onerow$type = paste(onerow$type1, onerow$type2)
} else {
onerow$type = "Polymorphism Disease"
}
}
lapply(snp_dist_nof_var, add_type_column)
source('~/SIFTS.py/analysis.R')
View(snp_dist_nof_var)
apply(snp_dist_nof_var, 1, add_type_column)
add_type_column <- function(onerow){
print(onerow)
if (onerow[,"type1"] == onerow[,"type2"]) {
onerow[,"type1"] = paste(onerow[,"type1"], onerow[,"type2"])
} else {
onerow[,"type"] = "Polymorphism Disease"
}
}
apply(snp_dist_nof_var, 1, add_type_column)
add_type_column <- function(onerow){
print(onerow)
if (onerow["type1"] == onerow["type2"]) {
onerow[,"type1"] = paste(onerow["type1"], onerow["type2"])
} else {
onerow["type"] = "Polymorphism Disease"
}
}
apply(snp_dist_nof_var, 1, add_type_column)
source('~/SIFTS.py/analysis.R')
add_type_column <- function(onerow){
print(onerow)
if (onerow["type1"] == onerow["type2"]) {
onerow["type"] = paste(onerow["type1"], onerow["type2"])
} else {
onerow["type"] = "Polymorphism Disease"
}
}
apply(snp_dist_nof_var, 1, add_type_column)
add_type_column <- function(onerow){
if (onerow["type1"] == onerow["type2"]) {
onerow["type"] = paste(onerow["type1"], onerow["type2"])
} else {
onerow["type"] = "Polymorphism Disease"
}
}
apply(snp_dist_nof_var, 1, add_type_column)
View(snp_dist_nof_var)
View(snp_dist_nof_var)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~.)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~.) + coord_cartesian(xlim = c(0, 50))
snp_dist_nof_var$type = paste(sort(c(snp_dist_nof_var$type1,snp_dist_nof_var$type2))
)
View(snp_dist_nof_var)
snp_dist_nof_var$type = paste(snp_dist_nof_var$type1,snp_dist_nof_var$type2)
View(snp_dist_nof_var)
snp_dist_nof_var[snp_dist_nof_var$type1 != snp_dist_nof_var$type2,"type"] <- "Polymorphism Disease"
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50)) + scale_colour_brewer()
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50)) + scale_colour_brewer(palette="Blues")
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=TRUE) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50)) + scale_colour_brewer(palette="Blues")
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50)) + scale_colour_brewer(type="seq", palette=3)
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +scale_colour_brewer(type="seq", palette=3)+ facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")) + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradientt(low = "white", high = "blue") + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
library("scales")
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradientt(low = "white", high = "blue") + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue") + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue") + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease", "Polymorphism Disease")), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue") + facet_grid(type ~.) + coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease", "Polymorphism Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Polymorphism Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ coord_cartesian(xlim = c(0, 50))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ coord_cartesian(xlim = c(0, 50), ylim=c(0,200))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50)) + scale_y_continuous(limits=c(0,200))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50)) + scale_y_continuous(limits=c(0,200), expand=c(0,0))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Disease Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(limits=c(0,200), expand=c(0,0))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Polymorphism Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(limits=c(0,200), expand=c(0,0))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Polymorphism Disease")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(expand=c(0,0))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified" & type %in% c("Polymorphism Polymorphism")), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(expand=c(0,0))
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(expand=c(0,0))
source('~/SIFTS.py/analysis.R')
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist)) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) + facet_grid(type1 + type2 ~.)
source('~/SIFTS.py/analysis.R')
ggplot(subset(snp_dist_nof_var,type1 != "Unclassified" & type2 != "Unclassified"), aes(x=spa_dist, y=seq_dist))  + facet_grid(type ~.) + stat_density2d(geom="tile",aes(fill=..density..), contour=FALSE) +  scale_fill_gradient(low = "white", high = "blue")+ scale_x_continuous(limits = c(0, 50), expand=c(0,0)) + scale_y_continuous(expand=c(0,0))
source('~/SIFTS.py/analysis.R')
source('~/SIFTS.py/analysis.R')
rnorm(n, sd=10) %% 1
rnorm(10, sd=10) %% 1
ans<-rnorm(10, sd=10)
ans
ans%%1
hist(rnorm(1000, sd=10) %% 1)
hist(rnorm(10000, sd=10) %% 1)
hist(rnorm(100000, sd=10) %% 1)
hist(rnorm(1000000, sd=10) %% 1)
hist(rnorm(10000000, sd=10) %% 1)
